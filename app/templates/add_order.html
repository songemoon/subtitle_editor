{% extends "base.html" %}

{% block title %}ğŸ“ ì˜ë¢° ë“±ë¡{% endblock %}

{% block content %}
<h2>ğŸ“ ì˜ë¢° ë“±ë¡</h2>

<form method="POST" style="max-width: 600px; background: #fff; padding: 30px; border-radius: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 30px;">
  <div style="margin-bottom: 20px;">
    <label for="client_id" style="display: block; font-weight: bold; margin-bottom: 5px;">í´ë¼ì´ì–¸íŠ¸</label>
    <select name="client_id" id="client_id" required style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px; background: #fff0f5;">
      {% for client in clients %}
      <option value="{{ client.id }}">{{ client.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div style="margin-bottom: 20px;">
    <label for="video_link" style="display: block; font-weight: bold; margin-bottom: 5px;">ì˜ìƒ ë§í¬</label>
    <input type="text" name="video_link" id="video_link" required style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px;" />
  </div>

  <div style="margin-bottom: 20px;">
    <label for="rate" style="display: block; font-weight: bold; margin-bottom: 5px;">ë‹¨ê°€ (â‚©/ë¶„)</label>
    <input type="number" name="rate_per_minute" id="rate" required style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px;" />
  </div>

  <div style="margin-bottom: 20px;">
    <label for="video_length" style="display: block; font-weight: bold; margin-bottom: 5px;">ì˜ìƒ ê¸¸ì´ (HH:MM:SS)</label>
    <input type="text" name="video_length" id="video_length" placeholder="ì˜ˆ: 00:12:30" required style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px;" />
  </div>

  <div style="margin-bottom: 20px;">
    <label style="display: block; font-weight: bold; margin-bottom: 5px;">ğŸ’° ì˜ˆìƒ ê°€ê²©</label>
    <div id="price_display" style="padding: 10px; background: #ffeef3; border-radius: 10px; font-weight: bold; color: #d6336c;">â‚©0</div>
  </div>

  <div style="margin-bottom: 20px;">
    <label for="deadline" style="display: block; font-weight: bold; margin-bottom: 5px;">ë§ˆê°ì¼</label>
    <input type="datetime-local" name="deadline" id="deadline" required style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px;" />
  </div>

  <div style="margin-bottom: 20px;">
    <label for="settlement_due" style="display: block; font-weight: bold; margin-bottom: 5px;">ì •ì‚° ì˜ˆì •ì¼</label>
    <input type="date" name="settlement_due" id="settlement_due" style="width: 100%; padding: 10px; border: 1px solid #ffc0cb; border-radius: 10px;" />
  </div>

  <button type="submit" class="btn">ğŸ“ ë“±ë¡</button>
</form>

<script>
  const rateInput = document.getElementById("rate");
  const lengthInput = document.getElementById("video_length");
  const priceDisplay = document.getElementById("price_display");

  function updatePrice() {
    const rate = parseFloat(rateInput.value || 0);
    const [h, m, s] = (lengthInput.value || "0:0:0").split(":").map(Number);
    const totalMinutes = h * 60 + m + s / 60;
    const price = Math.round(totalMinutes * rate);
    priceDisplay.innerText = `â‚©${price.toLocaleString()}`;
  }

  rateInput.addEventListener("input", updatePrice);
  lengthInput.addEventListener("input", updatePrice);
</script>
{% endblock %}
